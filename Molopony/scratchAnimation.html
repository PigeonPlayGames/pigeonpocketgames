<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Scratch Card</title>
<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
    * {
        padding: 0;
        margin: 0;
        box-sizing: border-box;
    }
    body {
        height: 100vh;
        background: linear-gradient(135deg, #c3a3f1, #6414e9);
        overflow: hidden; /* Prevent page from scrolling */
    }
    .container {
        width: 31em;
        height: 31em;
        background-color: #f5f5f5;
        position: absolute;
        transform: translate(-50%, -50%);
        top: 50%;
        left: 50%;
        border-radius: 0.6em;
        overflow: hidden; /* Hide overflow content */
    }
    .base {
        height: 200px;
        width: 200px;
        position: absolute;
        transform: translate(-50%, -50%);
        top: 50%;
        left: 50%;
        text-align: center;
        cursor: grabbing;
        border-radius: 0.3em;
        background-image: url('Images/lottery_inner1.png');
        background-size: cover;
    }
    #scratch {
        height: 200px;
        width: 200px;
        position: absolute;
        transform: translate(-50%, -50%);
        top: 50%;
        left: 50%;
        cursor: grabbing;
        border-radius: 0.3em;
    }
    .base h3 {
        font-weight: 600;
        font-size: 1.5em;
        color: #17013b;
    }
    .base h4 {
        font-weight: 400;
        color: #7FFFD4;
    }
    #scratch {
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        user-select: none;
    }
</style>
</head>
<body>
<div class="container">
  <div class="base">
    <h4>You Left Your Van Window Open And Someone Stole Your Mobile.</h4>
    <h3>$ Pay V100</h3>
  </div>
  <canvas id="scratch" width="200" height="200"></canvas>
</div>
<script>
    let canvas = document.getElementById("scratch");
    let context = canvas.getContext("2d");

    const init = () => {
        let gradientColor = context.createLinearGradient(0, 0, 135, 135);
        gradientColor.addColorStop(0, "#c3a3f1");
        gradientColor.addColorStop(1, "#6414e9");
        context.fillStyle = gradientColor;
        context.fillRect(0, 0, 200, 200);
    };

    //initially mouse X and mouse Y positions are 0
    let mouseX = 0;
    let mouseY = 0;
    let isDragged = false;

    //Particles
    let particles = [];
    const numParticles = 30;

    //Events for touch and mouse
    let events = {
        mouse: {
            down: "mousedown",
            move: "mousemove",
            up: "mouseup",
        },
        touch: {
            down: "touchstart",
            move: "touchmove",
            up: "touchend",
        },
    };

    let deviceType = "";

    //Detect touch device
    const isTouchDevice = () => {
        try {
            //We try to create TouchEvent. It would fail for desktops and throw an error.
            document.createEvent("TouchEvent");
            deviceType = "touch";
            return true;
        } catch (e) {
            deviceType = "mouse";
            return false;
        }
    };

    //Get left and top of canvas
    let rectLeft = canvas.getBoundingClientRect().left;
    let rectTop = canvas.getBoundingClientRect().top;

    //Exact x and y position of mouse/touch
    const getXY = (e) => {
        mouseX = (!isTouchDevice() ? e.pageX : e.touches[0].pageX) - rectLeft;
        mouseY = (!isTouchDevice() ? e.pageY : e.touches[0].pageY) - rectTop;
    };

    //Create particle
    const createParticle = (x, y) => {
        particles.push({
            x,
            y,
            size: Math.random() * 4 + 2, // Random size between 2 and 6
            color: "#ffffff", // White color
            angle: Math.random() * 2 * Math.PI, // Random angle in radians
            speed: Math.random() * 3 + 1, // Random speed between 1 and 4
        });
    };

    //Draw particles
    const drawParticles = () => {
        particles.forEach((particle, index) => {
            context.fillStyle = particle.color;
            context.beginPath();
            context.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
            context.fill();
            // Update particle position
            particle.x += Math.cos(particle.angle) * particle.speed;
            particle.y += Math.sin(particle.angle) * particle.speed;
            // Reduce particle size over time
            particle.size -= 0.1;
            // Remove particle if it becomes too small or leaves the canvas
            if (particle.size <= 0 || particle.x < 0 || particle.x > canvas.width || particle.y < 0 || particle.y > canvas.height) {
                particles.splice(index, 1);
            }
        });
    };

    isTouchDevice();
    //Start Scratch
    canvas.addEventListener(events[deviceType].down, (event) => {
        isDragged = true;
        //Get x and y position
        getXY(event);
        scratch(mouseX, mouseY);
    });

    //mousemove/touchmove
    canvas.addEventListener(events[deviceType].move, (event) => {
        if (!isTouchDevice()) {
            event.preventDefault();
        }
        if (isDragged) {
            getXY(event);
            scratch(mouseX, mouseY);
        }
    });

    //stop drawing
    canvas.addEventListener(events[deviceType].up, () => {
        isDragged = false;
    });

    //If mouse leaves the square
    canvas.addEventListener("mouseleave", () => {
        isDragged = false;
    });

    const scratch = (x, y) => {
        //destination-out draws new shapes behind the existing canvas content
        context.globalCompositeOperation = "destination-out";
        context.beginPath();
        //arc makes circle - x,y,radius,start angle,end angle
        context.arc(x, y, 12, 0, 2 * Math.PI);
        context.fill();
        // Create particles
        for (let i = 0; i < numParticles; i++) {
            createParticle(x, y);
        }
    };

    // Animation loop
    const animate = () => {
        // Clear canvas
        context.clearRect(0, 0, canvas.width, canvas.height);
        // Draw particles
        drawParticles();
        // Request animation frame
        requestAnimationFrame(animate);
    };

    // Start animation loop
    animate();

    window.onload = init();
</script>
</body>
</html>
